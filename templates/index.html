{% extends 'base.html' %}
{% block content %}
<div class="chat-wrapper">
    <aside class="sidebar">
        <div class="sidebar-header" style="padding: 1.5rem; border-bottom: 1px solid var(--glass-border);">
            <h2
                style="font-size: 1.5rem; background: var(--accent-gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">
                Chatzy</h2>
        </div>

        <div id="rooms-list" style="flex: 1; overflow-y: auto; padding: 1rem;">
            <!-- Rooms will be loaded here -->
        </div>

        <div class="sidebar-footer"
            style="padding: 1rem; border-top: 1px solid var(--glass-border); display: flex; align-items: center; gap: 1rem;">
            <div class="user-avatar"
                style="width: 40px; height: 40px; border-radius: 50%; background: var(--accent); display: flex; align-items: center; justify-content: center; font-weight: bold;">
                U
            </div>
            <div>
                <div id="user-name" style="font-weight: 600; font-size: 0.9rem;">User</div>
                <div style="font-size: 0.75rem; color: var(--text-secondary); cursor: pointer;"
                    onclick="localStorage.clear(); window.location.href='/auth/'">Logout</div>
            </div>
        </div>
    </aside>

    <main class="main-chat">
        <header
            style="padding: 1.5rem; border-bottom: 1px solid var(--glass-border); background: var(--glass-bg); backdrop-filter: blur(8px); display: flex; justify-content: space-between; align-items: center;">
            <h3 id="current-room-name">Select a room to start chatting</h3>
            <button class="btn btn-sm" onclick="showCreateRoomModal()">+ New Room</button>
        </header>

        <div id="messages-container" class="messages-container">
            <!-- Messages will be loaded here -->
            <div style="text-align: center; color: var(--text-secondary); margin-top: 4rem;">
                <p>Welcome to Chatzy! Select a conversation from the sidebar.</p>
            </div>
        </div>

        <footer style="padding: 1.5rem; background: var(--glass-bg); border-top: 1px solid var(--glass-border);">
            <form id="send-form" style="display: flex; gap: 1rem;">
                <input type="text" id="msg-input" placeholder="Type a message..." style="flex: 1;" autocomplete="off">
                <button type="submit" class="btn">Send</button>
            </form>
        </footer>
    </main>
</div>

<!-- Room Creation Modal -->
<div id="create-room-modal" class="modal-overlay" style="display: none;">
    <div class="modal">
        <div class="modal-header">
            <h3>Create New Room</h3>
            <span class="close-modal" onclick="hideCreateRoomModal()">&times;</span>
        </div>
        <div class="modal-body">
            <div class="input-group">
                <label>Room Name</label>
                <input type="text" id="modal-room-name" placeholder="E.g. Project X">
            </div>
            <div class="input-group">
                <label>Invite Participants</label>
                <input type="text" id="user-search" placeholder="Search users..." oninput="searchUsers(this.value)">
                <div id="user-search-results" class="search-results"></div>
            </div>
            <div id="selected-participants" class="selected-tags">
                <!-- Selected users will appear here -->
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="hideCreateRoomModal()">Cancel</button>
            <button class="btn" onclick="submitCreateRoom()">Create Room</button>
        </div>
    </div>
</div>
{% endblock %}